<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" th:href="@{/styles/lib/layui-v2.5.5/css/layui.css}" media="all">
</head>
<body>
<div id="tree" class="demo-tree-more"></div>
</body>
<script th:src="@{/styles/lib/layui-v2.5.5/layui.js}" charset="utf-8"></script>
<script th:src="@{/styles/lib/jquery-3.4.1/jquery-3.4.1.min.js}" charset="utf-8"></script>
<!--导入自定义的一些公共方法-->
<script th:src="@{/styles/js/my_function.js}"></script>
<script>
    layui.use(['tree', 'util'], function () {
        var tree = layui.tree,
            data = "";

        ajax_hasData('/menu/all', 'GET', null, function (rest) {
            //将查询的child转换为children
            data = JSON.parse(JSON.stringify(rest.menuInfo).replace(/"child"/g, '"children"'));
        }, null, false);

        //仅节点左侧图标控制收缩
        tree.render({
            elem: '#tree',
            data: data,
            children: 'child',
            onlyIconControl: true, //是否仅允许节点左侧图标控制展开收缩
            click: function (obj) {
                localStorage.pid = obj.data.id;
                localStorage.title = obj.data.title;
                var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
                parent.layer.close(index); //再执行关闭
            }
        });
    });
</script>
</html>